# RunPaceFlow MVP å®æ–½è®¡åˆ’

**ç‰ˆæœ¬**: v3.0 (æç®€ç‰ˆ)
**åˆ›å»ºæ—¥æœŸ**: 2025-01-04
**æ›´æ–°æ—¥æœŸ**: 2025-01-05
**é¢„è®¡å‘¨æœŸ**: 3-4 å‘¨
**ç›®æ ‡**: æ„å»ºå•ç”¨æˆ·è·‘æ­¥è®°å½•ç³»ç»Ÿï¼ŒéªŒè¯æ ¸å¿ƒåŠŸèƒ½

---

## ç›®å½•

1. [ç‰ˆæœ¬å˜æ›´è¯´æ˜](#ç‰ˆæœ¬å˜æ›´è¯´æ˜)
2. [åŠŸèƒ½èŒƒå›´](#åŠŸèƒ½èŒƒå›´)
3. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
4. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
5. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
6. [æ ¸å¿ƒç»„ä»¶è®¾è®¡](#æ ¸å¿ƒç»„ä»¶è®¾è®¡)
7. [å¼€å‘æ—¶é—´çº¿](#å¼€å‘æ—¶é—´çº¿)
8. [éªŒæ”¶æ ‡å‡†](#éªŒæ”¶æ ‡å‡†)
9. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
10. [FAQ](#faq)

---

## ç‰ˆæœ¬å˜æ›´è¯´æ˜

### v3.0 ä¸»è¦å˜æ›´

- ğŸ—‘ï¸ **ç§»é™¤è®¾ç½®é¡µé¢** - é€šè¿‡ç¯å¢ƒå˜é‡é…ç½® Nike token
- ğŸ® **ç®€åŒ–è·¯çº¿å›æ”¾** - ç§»é™¤è¿›åº¦æ¡/é€Ÿåº¦è°ƒèŠ‚ï¼Œä»…ä¿ç•™æ’­æ”¾æŒ‰é’®
- ğŸ—ºï¸ **MapLibre æ›¿ä»£ Mapbox** - å¼€æºå…è´¹æ–¹æ¡ˆ
- â±ï¸ **ç¼©çŸ­å‘¨æœŸ** - ä» 4-5 å‘¨ç¼©çŸ­åˆ° 3-4 å‘¨

### MVP æ ¸å¿ƒç›®æ ‡

- âœ… Nike Run Club æ•°æ®è‡ªåŠ¨åŒæ­¥
- âœ… åœ°å›¾å±•ç¤ºå’Œç®€åŒ–è·¯çº¿å›æ”¾
- âœ… é…é€Ÿåˆ†æå’Œå¯è§†åŒ–
- âœ… å“åº”å¼è®¾è®¡

---

## åŠŸèƒ½èŒƒå›´

### âœ… åŒ…å«åŠŸèƒ½

| åŠŸèƒ½æ¨¡å—   | æè¿°                                   |
| ---------- | -------------------------------------- |
| æ•°æ®åŒæ­¥   | Nike Run Club è‡ªåŠ¨åŒæ­¥ï¼ˆç¯å¢ƒå˜é‡é…ç½®ï¼‰ |
| åœ°å›¾å±•ç¤º   | åŸºäº MapLibre çš„åœ°å›¾æ¸²æŸ“               |
| è·¯çº¿å›æ”¾   | ActivityCard æ’­æ”¾æŒ‰é’®è§¦å‘åŠ¨ç”»ç»˜åˆ¶      |
| é…é€Ÿå¯è§†åŒ– | æ¸å˜è‰²è·¯çº¿ + æ¯å…¬é‡Œæ ‡è®°ç‚¹              |
| é…é€Ÿåˆ†æ   | æ¯å…¬é‡Œé…é€Ÿå›¾è¡¨ + åˆ†æ®µæ•°æ®è¡¨            |
| å“åº”å¼è®¾è®¡ | ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯é€‚é…                     |

### âŒ ä¸åŒ…å«åŠŸèƒ½

- è®¾ç½®é¡µé¢ï¼ˆç¯å¢ƒå˜é‡é…ç½®ï¼‰
- å¤æ‚æ’­æ”¾æ§åˆ¶å™¨ï¼ˆè¿›åº¦æ¡ã€é€Ÿåº¦è°ƒèŠ‚ï¼‰
- AI æ™ºèƒ½å»ºè®®
- å¤šç”¨æˆ·ç³»ç»Ÿ
- ç¤¾äº¤åŠŸèƒ½
- ç§»åŠ¨ç«¯ Native App
- 3D åœ°å½¢è§†å›¾
- Strava/Garminï¼ˆé¢„ç•™æ¥å£ï¼‰

---

## æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆé€‰å‹

```yaml
å‰ç«¯:
  æ¡†æ¶: Next.js 15 (App Router) + React 19 + TypeScript
  UI: Tailwind CSS 4 + shadcn/ui + Radix UI
  åŠ¨ç”»: Framer Motion (æŒ‰éœ€)

çŠ¶æ€ç®¡ç†:
  Jotai: åŸå­åŒ–çŠ¶æ€ç®¡ç†
  TanStack Query: æ•°æ®è·å–å’Œç¼“å­˜

åç«¯:
  API: tRPC + Zod
  æ•°æ®åº“: SQLite (å¼€å‘) / Turso (ç”Ÿäº§)
  ORM: Drizzle ORM

åœ°å›¾:
  MapLibre GL JS: å¼€æºåœ°å›¾æ¸²æŸ“
  react-map-gl: React å°è£…
  @turf/turf: åœ°ç†è®¡ç®—

å›¾è¡¨:
  Recharts: é…é€Ÿå›¾è¡¨

å·¥å…·:
  pnpm: åŒ…ç®¡ç†
  ESLint + Prettier: ä»£ç è´¨é‡
```

### å…³é”®æŠ€æœ¯å†³ç­–

**MapLibre vs Mapbox**

- âœ… å®Œå…¨å…è´¹å¼€æº
- âœ… API ä¸ Mapbox GL JS å…¼å®¹
- âœ… æ ·å¼å…¼å®¹ Mapbox
- âœ… æ— ä½¿ç”¨é™åˆ¶

**é€‚é…å™¨æ¨¡å¼**

- ç»Ÿä¸€æ•°æ®æºæ¥å£
- Nike ä¼˜å…ˆå®ç°
- Strava/Garmin é¢„ç•™æ‰©å±•

---

## é¡¹ç›®ç»“æ„

```
runPaceFlow/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (main)/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx         # é¦–é¡µï¼ˆæ´»åŠ¨åˆ—è¡¨ + åœ°å›¾ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ activity/[id]/   # æ´»åŠ¨è¯¦æƒ…
â”‚   â”‚   â””â”€â”€ api/trpc/[trpc]/     # tRPC ç«¯ç‚¹
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/                  # shadcn/ui ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ map/                 # åœ°å›¾ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ RunMap.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ RouteLayer.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MarkerLayer.tsx
â”‚   â”‚   â”‚   â””â”€â”€ AnimatedRoute.tsx
â”‚   â”‚   â”œâ”€â”€ activity/            # æ´»åŠ¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ActivityCard.tsx # å¸¦æ’­æ”¾æŒ‰é’®
â”‚   â”‚   â”‚   â”œâ”€â”€ PaceChart.tsx
â”‚   â”‚   â”‚   â””â”€â”€ SplitsTable.tsx
â”‚   â”‚   â””â”€â”€ layout/
â”‚   â”‚       â””â”€â”€ Header.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ db/                  # æ•°æ®åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ schema.ts
â”‚   â”‚   â”‚   â””â”€â”€ client.ts
â”‚   â”‚   â”œâ”€â”€ trpc/                # tRPC
â”‚   â”‚   â”‚   â”œâ”€â”€ server.ts
â”‚   â”‚   â”‚   â””â”€â”€ routers/
â”‚   â”‚   â”œâ”€â”€ sync/                # æ•°æ®åŒæ­¥
â”‚   â”‚   â”‚   â”œâ”€â”€ adapters/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ base.ts      # é€‚é…å™¨æ¥å£
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ nike.ts      # Nike é€‚é…å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ parser.ts        # GPX è§£æ
â”‚   â”‚   â”‚   â””â”€â”€ processor.ts     # æ•°æ®å¤„ç†
â”‚   â”‚   â”œâ”€â”€ pace/                # é…é€Ÿè®¡ç®—
â”‚   â”‚   â”‚   â”œâ”€â”€ calculator.ts
â”‚   â”‚   â”‚   â””â”€â”€ analyzer.ts
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/                  # Jotai çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ ui.ts
â”‚   â”‚   â””â”€â”€ map.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                   # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”œâ”€â”€ use-activities.ts
â”‚   â”‚   â”œâ”€â”€ use-activity-detail.ts
â”‚   â”‚   â””â”€â”€ use-route-animation.ts
â”‚   â”‚
â”‚   â””â”€â”€ types/                   # ç±»å‹å®šä¹‰
â”‚       â”œâ”€â”€ activity.ts
â”‚       â””â”€â”€ map.ts
â”‚
â””â”€â”€ drizzle/                     # æ•°æ®åº“è¿ç§»
```

---

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

#### 1. activities (æ´»åŠ¨è¡¨)

```typescript
{
  id: text(ä¸»é”®)
  title: text
  type: text // 'running' | 'cycling' | 'walking'
  source: text // 'nike' | 'strava' | 'garmin'
  sourceId: text // åŸå§‹å¹³å°ID

  startTime: timestamp
  endTime: timestamp
  duration: integer // ç§’
  distance: real // ç±³

  averagePace: real // ç§’/å…¬é‡Œ
  bestPace: real // ç§’/å…¬é‡Œ
  elevationGain: real // ç±³

  averageHeartRate: integer
  maxHeartRate: integer
  calories: integer

  gpxData: text // å®Œæ•´ GPX XML

  createdAt: timestamp
  updatedAt: timestamp
}
```

#### 2. splits (åˆ†æ®µè¡¨)

```typescript
{
  id: text(ä¸»é”®)
  activityId: text(å¤–é”®)
  kilometer: integer // ç¬¬å‡ å…¬é‡Œ
  duration: integer // ç§’
  pace: real // ç§’/å…¬é‡Œ
  distance: real // ç±³
  elevationGain: real
  averageHeartRate: integer
  createdAt: timestamp
}
```

#### 3. userProfile (ç”¨æˆ·é…ç½®)

```typescript
{
  id: text(ä¸»é”®)
  name: text
  avatar: text

  syncSource: text
  nikeAccessToken: text
  stravaAccessToken: text
  garminSecretString: text

  lastSyncAt: timestamp
  createdAt: timestamp
  updatedAt: timestamp
}
```

#### 4. syncLogs (åŒæ­¥æ—¥å¿—)

```typescript
{
  id: text(ä¸»é”®)
  source: text
  status: text // 'success' | 'failed' | 'running'
  activitiesCount: integer
  errorMessage: text
  startedAt: timestamp
  completedAt: timestamp
}
```

---

## æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 1. é€‚é…å™¨æ¨¡å¼ï¼ˆæ ¸å¿ƒæ¶æ„ï¼‰

#### åŸºç¡€æ¥å£

```typescript
// src/lib/sync/adapters/base.ts
export interface SyncAdapter {
  name: string
  authenticate(credentials: Record<string, any>): Promise<boolean>
  getActivities(options?: { startDate?: Date; endDate?: Date; limit?: number }): Promise<RawActivity[]>
  getActivityDetail(id: string): Promise<RawActivity>
  downloadGPX(activityId: string): Promise<string>
  healthCheck(): Promise<boolean>
}

export interface RawActivity {
  id: string
  title: string
  type: 'running' | 'cycling' | 'walking'
  startTime: Date
  duration: number // ç§’
  distance: number // ç±³
  gpxData?: string
  averagePace?: number
  source: string
}
```

#### Nike é€‚é…å™¨å®ç°

```typescript
// src/lib/sync/adapters/nike.ts
export class NikeAdapter implements SyncAdapter {
  name = 'nike'
  private accessToken: string

  constructor(accessToken: string) {
    this.accessToken = accessToken
  }

  async getActivities(options = {}): Promise<RawActivity[]> {
    const response = await fetch('https://api.nike.com/...', {
      headers: { Authorization: `Bearer ${this.accessToken}` },
    })
    const data = await response.json()
    return data.activities.map(this.transformActivity)
  }

  // ... å…¶ä»–æ–¹æ³•å®ç°
}
```

### 2. è·¯çº¿å›æ”¾ç»„ä»¶

```typescript
// src/components/map/AnimatedRoute.tsx

/**
 * ç®€åŒ–çš„è·¯çº¿å›æ”¾ç»„ä»¶
 * åŠŸèƒ½ï¼š
 * 1. ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„åŠ¨ç”»ç»˜åˆ¶
 * 2. æ˜¾ç¤ºæµ®åŠ¨ä¿¡æ¯å¡ï¼ˆå½“å‰é…é€Ÿã€è·ç¦»ã€æ—¶é—´ï¼‰
 * 3. åŠ¨ç”»å®Œæˆåæ˜¾ç¤ºå®Œæ•´çš„é…é€Ÿæ¸å˜è‰²è·¯çº¿
 */
export function AnimatedRoute({
  coordinates: Coordinate[],
  paceData: PaceData[],
  onAnimationComplete?: () => void
}) {
  const [currentIndex, setCurrentIndex] = useState(0);

  // ä½¿ç”¨ requestAnimationFrame å®ç°å¹³æ»‘åŠ¨ç”»
  useEffect(() => {
    if (!isPlaying) return;

    const animate = () => {
      setCurrentIndex(prev => {
        if (prev >= coordinates.length - 1) {
          onAnimationComplete?.();
          return prev;
        }
        return prev + 1;
      });
    };

    const id = requestAnimationFrame(animate);
    return () => cancelAnimationFrame(id);
  }, [isPlaying, currentIndex]);

  return (
    <>
      <Source data={currentRouteData}>
        <Layer {...routeLayerStyle} />
      </Source>
      <FloatingInfoCard
        pace={currentPace}
        distance={currentDistance}
        time={currentTime}
      />
    </>
  );
}
```

### 3. é¡µé¢äº¤äº’è®¾è®¡

#### é¦–é¡µå¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æ€»é‡Œç¨‹] [æœ¬å‘¨] [æ´»åŠ¨æ•°]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ´»åŠ¨åˆ—è¡¨       â”‚    åœ°å›¾              â”‚
â”‚                â”‚                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ™¨è·‘ 5.2km â”‚ â”‚  â”‚               â”‚ â”‚
â”‚ â”‚ â–¶ æ’­æ”¾     â”‚ â”‚  â”‚   æ‰€æœ‰è·¯çº¿     â”‚ â”‚
â”‚ â”‚ 5:30/km    â”‚ â”‚  â”‚               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’æµç¨‹**:

1. ç‚¹å‡» ActivityCard çš„ **â–¶ æ’­æ”¾** æŒ‰é’®
2. å³ä¾§åœ°å›¾èšç„¦åˆ°è¯¥æ´»åŠ¨è·¯çº¿
3. å¼€å§‹åŠ¨ç”»ç»˜åˆ¶è·¯çº¿
4. æ˜¾ç¤ºæµ®åŠ¨ä¿¡æ¯å¡ï¼ˆå®æ—¶é…é€Ÿ/è·ç¦»/æ—¶é—´ï¼‰
5. åŠ¨ç”»å®Œæˆï¼Œæ˜¾ç¤ºå®Œæ•´é…é€Ÿæ¸å˜è‰²è·¯çº¿

#### æ´»åŠ¨è¯¦æƒ…é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† è¿”å›  æ™¨è·‘ - 2025-01-04  â–¶ æ’­æ”¾  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [è·ç¦»] [ç”¨æ—¶] [é…é€Ÿ] [å¿ƒç‡] [çˆ¬å‡]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚    åœ°å›¾ï¼ˆé…é€Ÿæ¸å˜è‰²è·¯çº¿ï¼‰             â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    é…é€Ÿå›¾è¡¨                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    åˆ†æ®µæ•°æ®è¡¨                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¼€å‘æ—¶é—´çº¿

### Week 1: æ•°æ®å±‚ + Nike åŒæ­¥ (5-7å¤©)

**Day 1-2: é¡¹ç›®åˆå§‹åŒ–**

- [ ] åˆ›å»º Next.js é¡¹ç›®
- [ ] é…ç½® TypeScriptã€Tailwindã€ESLint
- [ ] å®‰è£…æ ¸å¿ƒä¾èµ–ï¼ˆMapLibreã€Jotaiã€tRPCç­‰ï¼‰
- [ ] è®¾ç½®é¡¹ç›®ç»“æ„

**Day 3-4: æ•°æ®åº“**

- [ ] è®¾è®¡ Drizzle schemaï¼ˆ4å¼ è¡¨ï¼‰
- [ ] å®ç°æ•°æ®åº“è¿ç§»
- [ ] ç¼–å†™æ•°æ®è®¿é—®å±‚

**Day 5-7: Nike åŒæ­¥**

- [ ] å®ç°é€‚é…å™¨æ¥å£
- [ ] Nike Adapter å¼€å‘
- [ ] GPX è§£æå™¨
- [ ] é…é€Ÿè®¡ç®—æœåŠ¡
- [ ] æµ‹è¯•æ•°æ®åŒæ­¥

**é‡Œç¨‹ç¢‘ M1**: Nike æ•°æ®æˆåŠŸåŒæ­¥åˆ°æ•°æ®åº“

---

### Week 2: API å±‚ + å‰ç«¯åŸºç¡€ (5-7å¤©)

**Day 1-2: tRPC API**

- [ ] é…ç½® tRPC
- [ ] å®ç° activity router
  - `activity.list` - è·å–æ´»åŠ¨åˆ—è¡¨
  - `activity.getById` - è·å–æ´»åŠ¨è¯¦æƒ…
  - `activity.getSplits` - è·å–åˆ†æ®µæ•°æ®

**Day 3-5: å‰ç«¯åŸºç¡€**

- [ ] é›†æˆ shadcn/ui
- [ ] åˆ›å»ºå¸ƒå±€ç»„ä»¶ï¼ˆHeaderï¼‰
- [ ] åˆ›å»ºåŸºç¡€ UI ç»„ä»¶
- [ ] é…ç½® Jotai çŠ¶æ€ç®¡ç†
- [ ] è®¾ç½® TanStack Query

**Day 6-7: æ´»åŠ¨åˆ—è¡¨é¡µ**

- [ ] ActivityCard ç»„ä»¶ï¼ˆå¸¦æ’­æ”¾æŒ‰é’®ï¼‰
- [ ] StatsCard ç»„ä»¶
- [ ] æ´»åŠ¨åˆ—è¡¨é¡µé¢
- [ ] åŠ è½½çŠ¶æ€ã€é”™è¯¯å¤„ç†

**é‡Œç¨‹ç¢‘ M2**: æ´»åŠ¨åˆ—è¡¨é¡µé¢å®Œæˆï¼Œæ’­æ”¾æŒ‰é’®æ­£å¸¸å·¥ä½œ

---

### Week 3: åœ°å›¾å¯è§†åŒ– + ç®€åŒ–å›æ”¾ (5-7å¤©)

**Day 1-2: åŸºç¡€åœ°å›¾**

- [ ] é›†æˆ MapLibre GL JS
- [ ] åˆ›å»º RunMap ç»„ä»¶
- [ ] è·¯çº¿ç»˜åˆ¶ï¼ˆLineStringï¼‰

**Day 3-4: é…é€Ÿå¯è§†åŒ–**

- [ ] é…é€Ÿé¢œè‰²æ˜ å°„ç®—æ³•
- [ ] æ¸å˜è‰²è·¯çº¿æ¸²æŸ“
- [ ] æ¯å…¬é‡Œæ ‡è®°ç‚¹
- [ ] Popup ä¿¡æ¯çª—å£

**Day 5-7: ç®€åŒ–è·¯çº¿å›æ”¾**

- [ ] AnimatedRoute ç»„ä»¶
- [ ] åŠ¨ç”»ç»˜åˆ¶ï¼ˆrequestAnimationFrameï¼‰
- [ ] æ’­æ”¾æŒ‰é’®é›†æˆåˆ° ActivityCard
- [ ] æµ®åŠ¨ä¿¡æ¯å¡ï¼ˆé…é€Ÿ/è·ç¦»/æ—¶é—´ï¼‰
- [ ] åŠ¨ç”»å®Œæˆåæ˜¾ç¤ºå®Œæ•´è·¯çº¿

**é‡Œç¨‹ç¢‘ M3**: åœ°å›¾å’Œç®€åŒ–å›æ”¾åŠŸèƒ½å®Œæˆ

---

### Week 3-4: é…é€Ÿåˆ†æ + è¯¦æƒ…é¡µ (5-7å¤©)

**Day 1-3: é…é€Ÿå›¾è¡¨**

- [ ] é›†æˆ Recharts
- [ ] PaceChart ç»„ä»¶
  - æ¯å…¬é‡Œé…é€ŸæŠ˜çº¿å›¾
  - å¹³å‡é…é€Ÿå‚è€ƒçº¿
  - æœ€å¿«é…é€Ÿæ ‡è®°
- [ ] SplitsTable ç»„ä»¶
  - åˆ†æ®µæ•°æ®è¡¨æ ¼
  - é«˜äº®æ˜¾ç¤º

**Day 4-7: æ´»åŠ¨è¯¦æƒ…é¡µ + ä¼˜åŒ–**

- [ ] é¡µé¢å¸ƒå±€è®¾è®¡
- [ ] é›†æˆåœ°å›¾å’Œç®€åŒ–å›æ”¾
- [ ] é›†æˆé…é€Ÿå›¾è¡¨å’Œåˆ†æ®µè¡¨
- [ ] ç»Ÿè®¡å¡ç‰‡
- [ ] å“åº”å¼å¸ƒå±€ä¼˜åŒ–
- [ ] ç§»åŠ¨ç«¯é€‚é…
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆè·¯çº¿ç®€åŒ–ã€æ‡’åŠ è½½ï¼‰

**é‡Œç¨‹ç¢‘ M4**: MVP å…¨åŠŸèƒ½å®Œæˆ

---

## éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

- [ ] Nike Run Club æ•°æ®æˆåŠŸåŒæ­¥ï¼ˆç¯å¢ƒå˜é‡é…ç½®ï¼‰
- [ ] é¦–é¡µæ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰æ´»åŠ¨åˆ—è¡¨
- [ ] æ´»åŠ¨å¡ç‰‡æ’­æ”¾æŒ‰é’®æ­£å¸¸å·¥ä½œ
- [ ] ç»Ÿè®¡å¡ç‰‡æ•°æ®å‡†ç¡®
- [ ] åœ°å›¾æ­£ç¡®æ˜¾ç¤ºè·‘æ­¥è·¯çº¿
- [ ] é…é€Ÿæ¸å˜è‰²è·¯çº¿æ˜¾ç¤ºæ­£ç¡®
- [ ] ç®€åŒ–è·¯çº¿å›æ”¾åŠ¨ç”»æµç•…
- [ ] åŠ¨ç”»è¿‡ç¨‹ä¸­å®æ—¶ä¿¡æ¯æ˜¾ç¤ºæ­£ç¡®
- [ ] é…é€Ÿå›¾è¡¨å‡†ç¡®æ˜¾ç¤º
- [ ] åˆ†æ®µæ•°æ®è¡¨å®Œæ•´
- [ ] ç§»åŠ¨ç«¯å“åº”å¼æ­£å¸¸

### æ€§èƒ½æ ‡å‡†

- [ ] é¦–å±åŠ è½½ < 3 ç§’
- [ ] åœ°å›¾æ¸²æŸ“ > 30 fps
- [ ] API å“åº” < 500ms
- [ ] æ”¯æŒ 100+ æ´»åŠ¨æ— æ€§èƒ½é—®é¢˜

### ä»£ç è´¨é‡

- [ ] TypeScript æ— ç±»å‹é”™è¯¯
- [ ] ESLint æ— è­¦å‘Š
- [ ] å…³é”®åŠŸèƒ½æœ‰å•å…ƒæµ‹è¯•
- [ ] ä»£ç æ³¨é‡Šå®Œæ•´

---

## å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–é¡¹ç›®

```bash
# åˆ›å»º Next.js é¡¹ç›®
npx create-next-app@latest runPaceFlow \
  --typescript \
  --tailwind \
  --app \
  --src-dir \
  --import-alias "@/*"

cd runPaceFlow

# å®‰è£…æ ¸å¿ƒä¾èµ–
pnpm add @tanstack/react-query @trpc/client @trpc/server @trpc/react-query
pnpm add jotai drizzle-orm @libsql/client
pnpm add maplibre-gl react-map-gl @turf/turf
pnpm add recharts zod lucide-react framer-motion

# å®‰è£… shadcn/ui
npx shadcn-ui@latest init

# å¼€å‘å·¥å…·
pnpm add -D drizzle-kit vitest
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# .env.local

# MapLibre (æ— éœ€ tokenï¼Œä½¿ç”¨å¼€æºæ ·å¼)
NEXT_PUBLIC_MAP_STYLE=https://demotiles.maplibre.org/style.json

# Nike Run Club
NIKE_ACCESS_TOKEN=your_nike_access_token

# Database
DATABASE_URL=file:./local.db
# ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ Turso
# DATABASE_URL=libsql://your-database.turso.io
# DATABASE_AUTH_TOKEN=your_auth_token
```

### 3. å¯åŠ¨å¼€å‘

```bash
# æ•°æ®åº“è¿ç§»
pnpm drizzle-kit push

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev
```

---

## FAQ

### Q1: ä¸ºä»€ä¹ˆç æ‰ AI åŠŸèƒ½å’Œè®¾ç½®é¡µé¢ï¼Ÿ

**A**:

- AI å¼€å‘å‘¨æœŸé•¿ï¼ˆ2å‘¨ï¼‰ï¼Œæˆæœ¬é«˜ï¼Œå¯¹ MVP éªŒè¯ä¸æ˜¯å¿…éœ€çš„
- è®¾ç½®é¡µé¢å¯é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®æ›¿ä»£ï¼ŒèŠ‚çœå¼€å‘æ—¶é—´
- ä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½ï¼šæ•°æ®åŒæ­¥ã€åœ°å›¾å±•ç¤ºã€é…é€Ÿåˆ†æ

### Q2: ä¸ºä»€ä¹ˆä¼˜å…ˆ Nike Run Clubï¼Ÿ

**A**:

- ç”¨æˆ·æ˜ç¡®éœ€æ±‚
- API ç›¸å¯¹ç®€å•
- æ•°æ®è´¨é‡å¥½
- é€‚é…å™¨æ¨¡å¼ä¾¿äºåç»­æ‰©å±• Strava/Garmin

### Q3: ä¸ºä»€ä¹ˆé€‰æ‹© MapLibre è€Œä¸æ˜¯ Mapboxï¼Ÿ

**A**:

- **å®Œå…¨å…è´¹**: MapLibre æ˜¯å¼€æºçš„ï¼Œæ— ä½¿ç”¨é™åˆ¶
- **API å…¼å®¹**: æ˜¯ Mapbox GL JS çš„åˆ†æ”¯ï¼ŒAPI å‡ ä¹ç›¸åŒ
- **æ ·å¼å…¼å®¹**: å¯ä»¥ä½¿ç”¨å¤§éƒ¨åˆ† Mapbox æ ·å¼
- **ç¤¾åŒºæ”¯æŒ**: æ´»è·ƒçš„å¼€æºç¤¾åŒº
- **æˆæœ¬è€ƒè™‘**: é¿å…äº† Mapbox çš„è´¹ç”¨é™åˆ¶

### Q4: ç®€åŒ–çš„è·¯çº¿å›æ”¾ä¸åŸè®¡åˆ’æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**A**:

- **ç§»é™¤**: è¿›åº¦æ¡ã€é€Ÿåº¦è°ƒèŠ‚ã€æ—¶é—´è½´æ§åˆ¶
- **ä¿ç•™**: ç®€å•çš„æ’­æ”¾æŒ‰é’®ã€åŠ¨ç”»ç»˜åˆ¶ã€å®æ—¶ä¿¡æ¯æ˜¾ç¤º
- **ä¼˜åŠ¿**: å¼€å‘æ›´å¿«ã€UI æ›´ç®€æ´ã€ç”¨æˆ·ä½“éªŒæ›´ç›´è§‚

### Q5: å¦‚ä½•ç¡®ä¿å…¶ä»–æ•°æ®æºæ˜“äºæ‰©å±•ï¼Ÿ

**A**:

- ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ç»Ÿä¸€æ¥å£
- å®šä¹‰æ¸…æ™°çš„ `SyncAdapter` æ¥å£
- æ•°æ®æ ¼å¼ç»Ÿä¸€è½¬æ¢ä¸º `RawActivity`
- é¢„ç•™ Strava/Garmin æ¥å£ï¼Œåªéœ€å®ç°å¯¹åº”é€‚é…å™¨

### Q6: åç»­æ‰©å±•è®¡åˆ’æ˜¯ä»€ä¹ˆï¼Ÿ

**A**:

- **Phase 2** (2-3å‘¨): Strava/Garmin é€‚é…å™¨ã€å¤šç”¨æˆ·æ”¯æŒ
- **Phase 3** (1-2æœˆ): AI æ™ºèƒ½å»ºè®®ã€è®­ç»ƒè®¡åˆ’ã€ç¤¾äº¤åŠŸèƒ½
- **Phase 4** (é•¿æœŸ): ç§»åŠ¨ç«¯ Appã€3D åœ°å½¢ã€æ¯”èµ›è®°å½•

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿå¼€å§‹ Week 1 å¼€å‘ï¼** ğŸš€

---

**æ–‡æ¡£ç‰ˆæœ¬**: v3.0
**æœ€åæ›´æ–°**: 2025-01-05
**ç»´æŠ¤è€…**: RunPaceFlow Team
